# ME249 Project 3 – Part 2 (PINN) 记录

本文件汇总当前 3.2 任务的参数、操作和产物，便于复现与汇报。

## 3.2.1 点集与自定义损失
- `CodeP3.3F25.ipynb` / `CodeP3.4F25.ipynb` 已填入：
  - 边界点 `pointsBoundaryChk`: 32 个坐标（0–5 cm 范围，周边按表格顺序）。
  - 内部点 `points`: 45 个坐标（0.5 cm 间隔的 5×9 网格）。
- 自定义损失（拉普拉斯残差 + 温度范围惩罚 + 边界残差）已集成到 `CodeP3.4F25.ipynb` 并在编译前定义。

## 3.2.2 当前训练配置（notebook 现状）
- 模型：5-10-1，`elu` 激活，输入 2D (x,y)，输出温度。
- 损失：`custom_loss_function`，`kappa=1.3`，温度范围惩罚同原始设定。
- 优化器：Adam，`learning_rate=5e-4`。
- 训练：`epochs=20000`，`batch_size=32`，`callbacks=[epoch_tracker]`，`verbose=0`。（cell3）
- 绘图：cell4/5 已加入 `plt.savefig`，自动保存到 `outputs/part2/pinn_scatter.png`、`pinn_surface.png`、`pinn_heatmap.png`（同时仍会 `plt.show()`）。

## 历史运行
- 早期尝试（lr=1e-3，epochs=5000，模型 20-40-20-1 或 5-10-1）得到 best loss ≈ 2.386（未达 0.005）。
- 当前配置尚需重新运行以更新 loss；运行 cell0–cell3 训练后查看 `smallest loss`，再运行绘图单元生成图像。

## 输出记录
- `outputs/part2/run_log.json`：记录当前配置与历史 run。当前配置条目预置了图像路径，训练完成后更新 `loss_best` 并确保图像生成。
- 训练后的图像：`outputs/part2/pinn_scatter.png`、`pinn_surface.png`、`pinn_heatmap.png`（运行绘图单元自动生成）。

## 操作指引
1. 依次运行 `CodeP3.4F25.ipynb` 的前四个单元（0–3）完成训练；目标 loss < 0.005。
2. 运行绘图单元（cell4/5），图会保存到 `outputs/part2/`，可用于与图 3.2.3 对比。
3. 将训练得到的 `smallest loss` 写回 `outputs/part2/run_log.json`，并在报告中说明是否满足基准目标。

---

# 3.2.3 改变 kappa 值（kappa=5.0 运行结果，追加记录）
- 配置：独立单元训练 `model_k5`（5-10-1, elu），epochs=20000，batch=32，kappa=5.0，不覆盖 kappa=1.3 流程。
- 结果更新：
  - lr=5e-4：best_epoch=20000，best_loss≈2.37e-05（达到 <0.01 目标），图像前缀 `lr5e-4_kappa5.0_*.png`。
  - lr=2e-4：best_epoch=19952，best_loss≈1.14e-05（进一步降低），图像同样使用 lr+kappa 命名（请运行绘图单元保存）。
- 图像（lr=5e-4 已生成）：`outputs/part2/lr5e-4_kappa5.0_scatter.png`、`lr5e-4_kappa5.0_surface.png`、`lr5e-4_kappa5.0_heatmap.png`。lr=2e-4 需运行绘图单元生成相应文件名。
- 评估：相较早期的高损失（0.0769 甚至 2.386），降低学习率至 5e-4、进一步到 2e-4 后，loss 显著下降至 1e-5 级别，满足基准要求。说明在高 kappa 下，较小学习率有助于稳定收敛；可将 lr=2e-4 + kappa=5.0 作为当前最佳配置。
