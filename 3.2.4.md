# ME249 Project 3 – Task 3.2.4（改变网络设计）

## 新建 Notebook
- 文件：`CodeP3.4F25_task3_2_4.ipynb`（复制 3.2.2 基线流程，调整网络结构）。
- 输出目录：`outputs/part3`（图像和指标存放于此，命名含 lr + kappa）。

## 配置
- 模型结构：`[8, 16, 1]`，激活 `elu`（输出层无激活）。
- 损失：`custom_loss_function`（kappa=1.3，温度范围惩罚同原始设定）。
- 优化器：Adam，`learning_rate=5e-4`。
- 训练：epochs=20000，batch_size=32，callbacks=[epoch_tracker]，verbose=0。
- 数据/点集：沿用 3.2.2 的 32 个边界点、45 个内部点。

## 绘图与输出
- 散点、曲面、热力图保存到 `outputs/part3/`，文件前缀：`lr5e-4_kappa1.3_net8-16-1_*`。
- 指标文件：训练后自动写入 `outputs/part3/metrics_net8-16-1.json`（best_epoch、best_loss）。

## 本次运行结果（已完成）
- 指标（初次跑 lr=5e-4）：`best_epoch = 20000`，`best_loss ≈ 0.0230`（`outputs/part3/metrics_net8-16-1.json` 旧版），未达 <0.01。
- 指标（最新跑 lr=2e-4）：`best_epoch = 19986`，`best_loss ≈ 0.001636`（`outputs/part3/metrics_net8-16-1.json` 已更新），达到 <0.01 目标。
- 图像（最新 lr=2e-4）：`outputs/part3/3.2.4 lr=2e-4_kappa1.3_scatter.png`、`..._surface.png`、`..._heatmap.png`。旧 lr=5e-4 图像仍在 `outputs/part3/lr5e-4_kappa1.3_net8-16-1_*.png`（以及 3.2.4_* 备份）。
- 评估：在固定 8-16-1 结构下，降低学习率至 2e-4 显著改善收敛，loss 从 0.023 降至 0.0016，满足目标。训练在 20000 轮末仍下降，表明更小 lr 提升了稳定性与精度。保持 kappa=1.3 即可，后续可视需要微调 lr 或 epochs 进一步压低损失。

## 操作指引
1) 运行 `CodeP3.4F25_task3_2_4.ipynb`：依次执行导入/数据 → 模型 → 损失 → 训练 → 绘图。  
2) 目标：loss < 0.01（或尽可能接近）。  
3) 训练完成后查看 `metrics_net8-16-1.json`，并与图 3.2.3 曲面对比评估精度/收敛。  
4) 如需进一步优化，可尝试降低学习率（如 2e-4）或延长 epochs。  
5) 将结果（best_loss、图像路径）补充到报告正文与 `run_log`（如需要）。***
